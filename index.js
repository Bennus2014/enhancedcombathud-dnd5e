/*! For license information please see index.js.LICENSE.txt */
(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}function n(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return c=e.done,e},e:function(e){u=!0,o=e},f:function(){try{c||null==n.return||n.return()}finally{if(u)throw o}}}}function r(){return r="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}},r.apply(this,arguments)}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function c(){c=function(){return e};var e={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",u=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function d(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),c=new D(r||[]);return a(o,"_invoke",{value:O(e,n,c)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=d;var p={};function m(){}function h(){}function y(){}var v={};l(v,o,(function(){return this}));var g=Object.getPrototypeOf,b=g&&g(g(E([])));b&&b!==n&&r.call(b,o)&&(v=b);var w=y.prototype=m.prototype=Object.create(v);function k(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function x(e,n){function i(a,o,c,u){var s=f(e[a],e,o);if("throw"!==s.type){var l=s.arg,d=l.value;return d&&"object"==t(d)&&r.call(d,"__await")?n.resolve(d.__await).then((function(e){i("next",e,c,u)}),(function(e){i("throw",e,c,u)})):n.resolve(d).then((function(e){l.value=e,c(l)}),(function(e){return i("throw",e,c,u)}))}u(s.arg)}var o;a(this,"_invoke",{value:function(e,t){function r(){return new n((function(n,r){i(e,t,n,r)}))}return o=o?o.then(r,r):r()}})}function O(e,t,n){var r="suspendedStart";return function(a,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw i;return{value:void 0,done:!0}}for(n.method=a,n.arg=i;;){var o=n.delegate;if(o){var c=A(o,n);if(c){if(c===p)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=f(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}function A(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),p;var a=f(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,p;var i=a.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function N(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function D(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(N,this),this.reset(!0)}function E(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,a=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return a.next=a}}return{next:j}}function j(){return{value:void 0,done:!0}}return h.prototype=y,a(w,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:h,configurable:!0}),h.displayName=l(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,l(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},k(x.prototype),l(x.prototype,u,(function(){return this})),e.AsyncIterator=x,e.async=function(t,n,r,a,i){void 0===i&&(i=Promise);var o=new x(d(t,n,r,a),i);return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},k(w),l(w,s,"Generator"),l(w,o,(function(){return this})),l(w,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=E,D.prototype={constructor:D,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var a=this.tryEntries.length-1;a>=0;--a){var i=this.tryEntries[a],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;T(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),p}},e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,n){for(var r=0;r<n.length;r++){var a=n[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,(void 0,i=function(e,n){if("object"!==t(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var a=r.call(e,"string");if("object"!==t(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(a.key),"symbol"===t(i)?i:String(i)),a)}var i}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&f(e,t)}function f(e,t){return f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},f(e,t)}function p(e){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,a=m(e);if(n){var i=m(this).constructor;r=Reflect.construct(a,arguments,i)}else r=a.apply(this,arguments);return function(e,n){if(n&&("object"===t(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function m(e){return m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},m(e)}function h(e,t,n,r,a,i,o){try{var c=e[i](o),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,a)}function y(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var i=e.apply(t,n);function o(e){h(i,r,a,o,c,"next",e)}function c(e){h(i,r,a,o,c,"throw",e)}o(void 0)}))}}e.d({},{c:()=>b});var v={};function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b="enhancedcombathud-dnd5e";Hooks.on("init",(function(){!function(e){for(var t=0,n=Object.entries(e);t<n.length;t++){var r=(c=2,function(e){if(Array.isArray(e))return e}(o=n[t])||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,i,o,c=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(c.push(r.value),c.length!==t);u=!0);}catch(e){s=!0,a=e}finally{try{if(!u&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(s)throw a}}return c}}(o,c)||function(e,t){if(e){if("string"==typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}(o,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],i=r[1];game.settings.register(b,a,i)}var o,c}({showWeaponsItems:{name:game.i18n.localize("enhancedcombathud-dnd5e.settings.showWeaponsItems.name"),hint:game.i18n.localize("enhancedcombathud-dnd5e.settings.showWeaponsItems.hint"),scope:"world",config:!0,type:Boolean,default:!1,onChange:function(){return ui.ARGON.refresh()}},switchEquip:{name:game.i18n.localize("enhancedcombathud-dnd5e.settings.switchEquip.name"),hint:game.i18n.localize("enhancedcombathud-dnd5e.settings.switchEquip.hint"),scope:"world",config:!0,type:Boolean,default:!0,onChange:function(){return ui.ARGON.refresh()}},noAA:{name:game.i18n.localize("enhancedcombathud-dnd5e.settings.noAA.name"),hint:game.i18n.localize("enhancedcombathud-dnd5e.settings.noAA.hint"),scope:"world",config:!0,type:Boolean,default:!1,onChange:function(){return ui.ARGON.refresh()}}})})),Hooks.on("setup",(function(){Hooks.on("argonInit",(function(e){if("dnd5e"===game.system.id){!function(){if(v[game.i18n.localize("enhancedcombathud-dnd5e.items.disengage.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.disengage.name"),type:"feat",img:"modules/enhancedcombathud/icons/journey.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.disengage.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:1,units:"turn"},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"}},effects:[{_id:"8FtZnIC1vbyKZ6xF",changes:[],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/journey.svg",label:"Disengage",origin:"Item.wyQkeuZkttllAFB1",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{core:{sourceId:"Item.wyQkeuZkttllAFB1"},"midi-qol":{onUseMacroName:""}}},v[game.i18n.localize("enhancedcombathud-dnd5e.items.dodge.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.dodge.name"),type:"feat",img:"modules/enhancedcombathud/icons/armor-upgrade.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.dodge.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:1,units:"round"},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"},consumableType:"trinket"},effects:[{_id:"2xH2YQ6pm430O0Aq",changes:[],disabled:!1,duration:{startTime:null,rounds:1},icon:"modules/enhancedcombathud/icons/armor-upgrade.svg",label:"Dodge",origin:"Item.pakEYcgLYxtKGv7J",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},v[game.i18n.localize("enhancedcombathud-dnd5e.items.ready.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.ready.name"),type:"feat",img:"modules/enhancedcombathud/icons/clockwork.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.ready.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"},consumableType:"trinket"},effects:[{_id:"BevDb0J80M9BdoEl",changes:[],disabled:!1,duration:{startTime:null,turns:1},icon:"modules/enhancedcombathud/icons/clockwork.svg",label:"Ready",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},v[game.i18n.localize("enhancedcombathud-dnd5e.items.hide.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.hide.name"),type:"feat",img:"modules/enhancedcombathud/icons/cloak-dagger.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.hide.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},recharge:{value:null,charged:!1},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"},consumableType:"trinket"},effects:[{_id:"SZkbtgGCICrpH0GJ",changes:[],disabled:!1,duration:{startTime:null,turns:10},icon:"modules/enhancedcombathud/icons/cloak-dagger.svg",label:"Hide",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},v[game.i18n.localize("enhancedcombathud-dnd5e.items.dash.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.dash.name"),type:"feat",img:"modules/enhancedcombathud/icons/walking-boot.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.dash.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:null,width:null,units:"",type:"self"},range:{value:null,long:null,units:""},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"},consumableType:"trinket"},effects:[{_id:"PPMPZY1t3AUB7UGA",changes:[],disabled:!1,duration:{startTime:null,rounds:1},icon:"modules/enhancedcombathud/icons/walking-boot.svg",label:"Dash",transfer:!1,flags:{dae:{stackable:"none",macroRepeat:"none",specialDuration:[],transfer:!1}},tint:""}],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},v[game.i18n.localize("enhancedcombathud-dnd5e.items.shove.name")]={name:game.i18n.localize("enhancedcombathud-dnd5e.items.shove.name"),type:"feat",img:"modules/enhancedcombathud/icons/shield-bash.svg",system:{description:{value:game.i18n.localize("enhancedcombathud-dnd5e.items.shove.desc"),chat:"",unidentified:""},source:"",quantity:1,weight:0,price:0,attuned:!1,attunement:0,equipped:!1,rarity:"",identified:!0,activation:{type:"action",cost:1,condition:""},duration:{value:null,units:""},target:{value:1,width:null,units:"",type:"creature"},range:{value:null,long:null,units:"touch"},consume:{type:"",target:"",amount:null},ability:"",actionType:"util",attackBonus:0,chatFlavor:"",critical:null,damage:{parts:[],versatile:""},formula:"",save:{ability:"",dc:null,scaling:"spell"},consumableType:"trinket"},effects:[],sort:0,flags:{"midi-qol":{onUseMacroName:""}}},game.settings.get("enhancedcombathud-dnd5e","noAA"))for(var e=0,t=Object.keys(v);e<t.length;e++){var n=t[e];delete v[n].effects}}();var t=e.ARGON,i={action:["action","legendary"],bonus:["bonus"],reaction:["reaction","reactiondamage","reactionmanual"],free:["special"]},o={spell:["spell"],feat:["feat"],consumable:["consumable","equipment","loot","weapon"]},s=function(e){d(a,e);var t,n,r=p(a);function a(){u(this,a);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return l(a,[{key:"description",get:function(){var e=this.actor,t=e.type,n=e.system,r=this.actor,a="character"===t;if("npc"===t){var i,o=game.i18n.localize(null!==(i=CONFIG.DND5E.creatureTypes[r.system.details.type.value])&&void 0!==i?i:r.system.details.type.custom),c=n.details.cr>=1||n.details.cr<=0?n.details.cr:"1/".concat(1/n.details.cr);return"CR ".concat(c," ").concat(o)}if(a){var u=Object.values(r.classes).map((function(e){return e.name})).join(" / ");return"Level ".concat(n.details.level," ").concat(u," (").concat(n.details.race,")")}return""}},{key:"isDead",get:function(){return this.isDying&&"character"!==this.actor.type}},{key:"isDying",get:function(){return this.actor.system.attributes.hp.value<=0}},{key:"successes",get:function(){var e,t;return null!==(e=null===(t=this.actor.system.attributes)||void 0===t||null===(t=t.death)||void 0===t?void 0:t.success)&&void 0!==e?e:0}},{key:"failures",get:function(){var e,t;return null!==(e=null===(t=this.actor.system.attributes)||void 0===t||null===(t=t.death)||void 0===t?void 0:t.failure)&&void 0!==e?e:0}},{key:"_onDeathSave",value:(n=y(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.actor.rollDeathSave({});case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"getStatBlocks",value:(t=y(c().mark((function e(){var t,n,r,a,i,o,u,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=game.i18n.localize("DND5E.HitPoints").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),a=game.i18n.localize("DND5E.ArmorClass").split(" ").map((function(e){return e.charAt(0).toUpperCase()})).join(""),i=game.i18n.localize("DND5E.SaveDC").replace("{ability}","").replace("{dc}","").trim(),o=this.actor.system.attributes.hp.temp?"#6698f3":"rgb(0 255 170)",u=this.actor.system.attributes.hp.tempmax,s=u?u>0?"rgb(222 91 255)":"#ffb000":"rgb(255 255 255)",e.abrupt("return",[[{text:"".concat(this.actor.system.attributes.hp.value+(null!==(t=this.actor.system.attributes.hp.temp)&&void 0!==t?t:0)),color:o},{text:"/"},{text:"".concat(this.actor.system.attributes.hp.max+(null!==(n=this.actor.system.attributes.hp.tempmax)&&void 0!==n?n:0)),color:s},{text:r}],[{text:a},{text:this.actor.system.attributes.ac.value,color:"var(--ech-movement-baseMovement-background)"}],[{text:i},{text:this.actor.system.attributes.spelldc,color:"var(--ech-movement-baseMovement-background)"}]]);case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),a}(t.PORTRAIT.PortraitPanel),f=function(e){d(r,e);var t,n=p(r);function r(e,t,a){var i;return u(this,r),(i=n.call(this,e)).item=t,i.type=a,i}return l(r,[{key:"hasTooltip",get:function(){return!0}},{key:"tooltipOrientation",get:function(){return TooltipManager.TOOLTIP_DIRECTIONS.RIGHT}},{key:"getTooltipData",value:(t=y(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(this.item,this.type);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),r}(t.DRAWER.DrawerButton),h=function(e){d(n,e);var t=p(n);function n(){u(this,n);for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];return t.call.apply(t,[this].concat(r))}return l(n,[{key:"categories",get:function(){var e=this,t=this.actor.system.abilities,n=this.actor.system.skills,r=this.actor.itemTypes.tool,a=function(e){return e>=0?"+".concat(e):e};return[{gridCols:"5fr 2fr 2fr",captions:[{label:"Abilities",align:"left"},{label:"Check",align:"center"},{label:"Save",align:"center"}],align:["left","center","center"],buttons:Object.keys(t).map((function(n){var r=t[n];return new f([{label:CONFIG.DND5E.abilities[n].label,onClick:function(t){return e.actor.rollAbility(n,{event:t})}},{label:a(r.mod),onClick:function(t){return e.actor.rollAbilityTest(n,{event:t})}},{label:a(r.save),onClick:function(t){return e.actor.rollAbilitySave(n,{event:t})}}],n,"save")}))},{gridCols:"7fr 2fr",captions:[{label:"Skills"},{label:""}],buttons:Object.keys(n).map((function(t){var r=n[t];return new f([{label:j(r.proficient)+CONFIG.DND5E.skills[t].label,onClick:function(n){return e.actor.rollSkill(t,{event:n})}},{label:"".concat(a(r.mod),'<span style="margin: 0 1rem; filter: brightness(0.8)">(').concat(r.passive,")</span>"),style:"display: flex; justify-content: flex-end;"}],t,"skill")}))},{gridCols:"7fr 2fr",captions:[{label:"Tools"},{label:""}],buttons:r.map((function(n){return new f([{label:j(n.system.proficient)+n.name,onClick:function(e){return n.rollToolCheck({event:e})}},{label:a(t[n.abilityMod].mod+n.system.proficiencyMultiplier*e.actor.system.attributes.prof)}],n)}))}]}},{key:"title",get:function(){return"".concat(game.i18n.localize("enhancedcombathud-dnd5e.hud.saves.name")," / ").concat(game.i18n.localize("enhancedcombathud-dnd5e.hud.skills.name")," / ").concat(game.i18n.localize("enhancedcombathud-dnd5e.hud.tools.name"))}}]),n}(t.DRAWER.DrawerPanel),g=function(e){d(a,e);var n,r=p(a);function a(){u(this,a);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return r.call.apply(r,[this].concat(t))}return l(a,[{key:"label",get:function(){return"DND5E.Action"}},{key:"hasAction",get:function(){return!0}},{key:"_getButtons",value:(n=y(c().mark((function e(){var n,r,a,o,u;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.actor.items.filter((function(e){var t;return"spell"===e.type&&i.action.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),r=this.actor.items.filter((function(e){var t;return"feat"===e.type&&i.action.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),a=this.actor.items.filter((function(e){var t;return"consumable"===e.type&&i.action.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),o=Object.values(v),u=[new x({item:null,isWeaponSet:!0,isPrimary:!0}),new t.MAIN.BUTTONS.SplitButton(new A(o[0]),new A(o[1])),new O({type:"spell",items:n,color:0}),new O({type:"feat",items:r,color:0}),new t.MAIN.BUTTONS.SplitButton(new A(o[2]),new A(o[3])),new t.MAIN.BUTTONS.SplitButton(new A(o[4]),new A(o[5])),new O({type:"consumable",items:a,color:0})],e.abrupt("return",u.filter((function(e){return null==e.items||e.items.length})));case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),a}(t.MAIN.ActionPanel),b=function(e){d(r,e);var t,n=p(r);function r(){u(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.call.apply(n,[this].concat(t))}return l(r,[{key:"label",get:function(){return"DND5E.BonusAction"}},{key:"hasAction",get:function(){return!0}},{key:"_getButtons",value:(t=y(c().mark((function e(){var t,n,r,u,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[new x({item:null,isWeaponSet:!0,isPrimary:!1})],n=c().mark((function e(){var n,o,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a(u[r],2),o=n[0],l=n[1],(d=s.actor.items.filter((function(e){var t;return l.includes(e.type)&&i.bonus.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)}))).length){e.next=4;break}return e.abrupt("return","continue");case 4:t.push(new O({type:o,items:d,color:1}));case 5:case"end":return e.stop()}}),e)})),r=0,u=Object.entries(o);case 3:if(!(r<u.length)){e.next=11;break}return e.delegateYield(n(),"t0",5);case 5:if("continue"!==e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:r++,e.next=3;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),r}(t.MAIN.ActionPanel),w=function(e){d(r,e);var t,n=p(r);function r(){u(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.call.apply(n,[this].concat(t))}return l(r,[{key:"label",get:function(){return"DND5E.Reaction"}},{key:"hasAction",get:function(){return!0}},{key:"_getButtons",value:(t=y(c().mark((function e(){var t,n,r,u,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[new x({item:null,isWeaponSet:!0,isPrimary:!0})],n=c().mark((function e(){var n,o,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a(u[r],2),o=n[0],l=n[1],(d=s.actor.items.filter((function(e){var t;return l.includes(e.type)&&i.reaction.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)}))).length){e.next=4;break}return e.abrupt("return","continue");case 4:t.push(new O({type:o,items:d,color:3}));case 5:case"end":return e.stop()}}),e)})),r=0,u=Object.entries(o);case 3:if(!(r<u.length)){e.next=11;break}return e.delegateYield(n(),"t0",5);case 5:if("continue"!==e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:r++,e.next=3;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),r}(t.MAIN.ActionPanel),k=function(e){d(r,e);var t,n=p(r);function r(){u(this,r);for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];return n.call.apply(n,[this].concat(t))}return l(r,[{key:"label",get:function(){return"DND5E.Special"}},{key:"hasAction",get:function(){return!0}},{key:"_getButtons",value:(t=y(c().mark((function e(){var t,n,r,u,s=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=c().mark((function e(){var n,o,l,d;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a(u[r],2),o=n[0],l=n[1],(d=s.actor.items.filter((function(e){var t;return l.includes(e.type)&&i.free.includes(null===(t=e.system.activation)||void 0===t?void 0:t.type)}))).length){e.next=4;break}return e.abrupt("return","continue");case 4:t.push(new O({type:o,items:d,color:2}));case 5:case"end":return e.stop()}}),e)})),r=0,u=Object.entries(o);case 3:if(!(r<u.length)){e.next=11;break}return e.delegateYield(n(),"t0",5);case 5:if("continue"!==e.t0){e.next=8;break}return e.abrupt("continue",8);case 8:r++,e.next=3;break;case 11:return e.abrupt("return",t);case 12:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),r}(t.MAIN.ActionPanel),x=function(e){d(f,e);var t,n,o,s=p(f);function f(){u(this,f);for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return s.call.apply(s,[this].concat(t))}return l(f,[{key:"hasTooltip",get:function(){return!0}},{key:"ranges",get:function(){var e,t,n,r,a,i=this.item,o="touch"==i.system.range.units?null===(e=canvas)||void 0===e||null===(e=e.scene)||void 0===e||null===(e=e.grid)||void 0===e?void 0:e.distance:null;return{normal:null!==(t=null===(n=i.system)||void 0===n||null===(n=n.range)||void 0===n?void 0:n.value)&&void 0!==t?t:o,long:null!==(r=null===(a=i.system)||void 0===a||null===(a=a.range)||void 0===a?void 0:a.long)&&void 0!==r?r:null}}},{key:"targets",get:function(){var e,t=this.item,n=t.system.actionType,r=null===(e=t.system.target)||void 0===e?void 0:e.type;return["creature","ally","enemy"].includes(r)?t.system.target.value:"mwak"===n||"rwak"===n?1:null}},{key:"getTooltipData",value:(o=y(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(this.item);case 2:return(t=e.sent).propertiesLabel="enhancedcombathud-dnd5e.tooltip.properties.name",e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"_onLeftClick",value:(n=y(c().mark((function e(t){return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ui.ARGON.interceptNextDialog(t.currentTarget),e.next=3,this.item.use({event:t},{event:t});case 3:e.sent&&f.consumeActionEconomy(this.item);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"render",value:(t=y(c().mark((function e(){var t,n,a,i,o,u,s=this,l=arguments;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=l.length,i=new Array(a),o=0;o<a;o++)i[o]=l[o];return e.next=3,(t=r(m(f.prototype),"render",this)).call.apply(t,[this].concat(i));case 3:"ammo"===(null===(n=this.item)||void 0===n?void 0:n.system.consumableType)&&(u=this.actor.items.filter((function(e){var t;return(null===(t=e.system.consume)||void 0===t?void 0:t.target)===s.item.id})),ui.ARGON.updateItemButtons(u));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"quantity",get:function(){var e,t,n,r=null===(e=this.item.system.consume)||void 0===e?void 0:e.type;if("ammo"===r){var a=this.actor.items.get(this.item.system.consume.target);return a?a.system.quantity:null}return"attribute"===r?getProperty(this.actor.system,this.item.system.consume.target):["consumable"].includes(this.item.type)?null!==(t=null===(n=this.item.system.uses)||void 0===n?void 0:n.value)&&void 0!==t?t:this.item.system.quantity:null}}],[{key:"consumeActionEconomy",value:function(e){for(var t,n=null===(t=e.system.activation)||void 0===t?void 0:t.type,r=null,o=0,c=Object.entries(i);o<c.length;o++){var u=a(c[o],2),s=u[0];u[1].includes(n)&&(r=s)}r&&("action"===r?ui.ARGON.components.main[0].isActionUsed=!0:"bonus"===r?ui.ARGON.components.main[1].isActionUsed=!0:"reaction"===r?ui.ARGON.components.main[2].isActionUsed=!0:"free"===r&&(ui.ARGON.components.main[3].isActionUsed=!0))}}]),f}(t.MAIN.BUTTONS.ItemButton),O=function(e){d(i,e);var n,r=p(i);function i(e){var t,n=e.type,a=e.items,o=e.color;return u(this,i),(t=r.call(this)).type=n,t.items=a,t.color=o,t}return l(i,[{key:"colorScheme",get:function(){return this.color}},{key:"label",get:function(){switch(this.type){case"spell":return"enhancedcombathud-dnd5e.hud.castspell.name";case"feat":return"enhancedcombathud-dnd5e.hud.usepower.name";case"consumable":return"enhancedcombathud-dnd5e.hud.useitem.name"}}},{key:"icon",get:function(){switch(this.type){case"spell":return"modules/enhancedcombathud/icons/spell-book.svg";case"feat":return"modules/enhancedcombathud/icons/mighty-force.svg";case"consumable":return"modules/enhancedcombathud/icons/drink-me.svg"}}},{key:"showPreparedOnly",get:function(){if("character"!==this.actor.type)return!1;var e=Object.keys(this.actor.classes);return["cleric","druid","paladin","wizard","artificer","ranger"].some((function(t){return e.includes(t)}))}},{key:"_getPanel",value:(n=y(c().mark((function e(){var n,r,i,o,u,s,l=this;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("spell"!==this.type){e.next=17;break}n=CONFIG.DND5E.spellLevels,this.showPreparedOnly&&(r=["atwill","innate","pact"],this.items=this.items.filter((function(e){return!!r.includes(e.system.preparation.mode)||0==e.system.level||e.system.preparation.prepared}))),i=[{label:"DND5E.SpellPrepAtWill",buttons:this.items.filter((function(e){return"atwill"===e.system.preparation.mode})).map((function(e){return new x({item:e})})),uses:{max:1/0,value:1/0}},{label:"DND5E.SpellPrepInnate",buttons:this.items.filter((function(e){return"innate"===e.system.preparation.mode})).map((function(e){return new x({item:e})})),uses:{max:1/0,value:1/0}},{label:Object.values(n)[0],buttons:this.items.filter((function(e){return 0==e.system.level})).map((function(e){return new x({item:e})})),uses:{max:1/0,value:1/0}},{label:"DND5E.PactMagic",buttons:this.items.filter((function(e){return"pact"===e.system.preparation.mode})).map((function(e){return new x({item:e})})),uses:this.actor.system.spells.pact}],o=c().mark((function e(){var t,n,r,o;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=a(s[u],2),n=t[0],r=t[1],(o=l.items.filter((function(e){return e.system.level==n}))).length&&0!=n){e.next=4;break}return e.abrupt("return","continue");case 4:i.push({label:r,buttons:o.map((function(e){return new x({item:e})})),uses:l.actor.system.spells["spell".concat(n)]});case 5:case"end":return e.stop()}}),e)})),u=0,s=Object.entries(n);case 6:if(!(u<s.length)){e.next=14;break}return e.delegateYield(o(),"t0",8);case 8:if("continue"!==e.t0){e.next=11;break}return e.abrupt("continue",11);case 11:u++,e.next=6;break;case 14:return e.abrupt("return",new t.MAIN.BUTTON_PANELS.ACCORDION.AccordionPanel({accordionPanelCategories:i.filter((function(e){return e.buttons.length})).map((function(e){var n=e.label,r=e.buttons,a=e.uses;return new t.MAIN.BUTTON_PANELS.ACCORDION.AccordionPanelCategory({label:n,buttons:r,uses:a})}))}));case 17:return e.abrupt("return",new t.MAIN.BUTTON_PANELS.ButtonPanel({buttons:this.items.map((function(e){return new x({item:e})}))}));case 18:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})}]),i}(t.MAIN.BUTTONS.ButtonPanelButton),A=function(e){d(a,e);var t,n,r=p(a);function a(e){var t;return u(this,a),(t=r.call(this)).item=new CONFIG.Item.documentClass(e,{parent:t.actor}),t}return l(a,[{key:"label",get:function(){return this.item.name}},{key:"icon",get:function(){return this.item.img}},{key:"hasTooltip",get:function(){return!0}},{key:"getTooltipData",value:(n=y(c().mark((function e(){var t;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D(this.item);case 2:return(t=e.sent).propertiesLabel="enhancedcombathud-dnd5e.tooltip.properties.name",e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_onLeftClick",value:(t=y(c().mark((function e(t){var n,r,a;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(null===(n=game.modules.get("dfreds-convenient-effects"))||void 0===n?void 0:n.active)&&game.dfreds.effectInterface.findEffectByName(this.label),a=!1,!r){e.next=8;break}return a=!0,e.next=6,game.dfreds.effectInterface.toggleEffect(this.label,{overlay:!1,uuids:[this.actor.uuid]});case 6:e.next=11;break;case 8:return e.next=10,this.item.use({event:t},{event:t});case 10:a=e.sent;case 11:a&&x.consumeActionEconomy(this.item);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),a}(t.MAIN.BUTTONS.ActionButton),N=function(e){d(n,e);var t=p(n);function n(){return u(this,n),t.apply(this,arguments)}return l(n,[{key:"movementMax",get:function(){return this.actor.system.attributes.movement.walk/canvas.scene.dimensions.distance}}]),n}(t.MovementHud),T=function(e){d(i,e);var t,n,a=p(i);function i(){return u(this,i),a.apply(this,arguments)}return l(i,[{key:"getDefaultSets",value:(n=y(c().mark((function e(){var t,n,a,o,u,s,l,d,f,p,h,y,v,g,b;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(m(i.prototype),"getDefaultSets",this).call(this);case 2:if(v=e.sent,"npc"===this.actor.type){e.next=5;break}return e.abrupt("return",v);case 5:return g=this.actor.items.filter((function(e){var t;return"weapon"===e.type&&"action"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),b=this.actor.items.filter((function(e){var t;return"weapon"===e.type&&"bonus"===(null===(t=e.system.activation)||void 0===t?void 0:t.type)})),e.abrupt("return",{1:{primary:null!==(t=null===(n=g[0])||void 0===n?void 0:n.uuid)&&void 0!==t?t:null,secondary:null!==(a=null===(o=b[0])||void 0===o?void 0:o.uuid)&&void 0!==a?a:null},2:{primary:null!==(u=null===(s=g[1])||void 0===s?void 0:s.uuid)&&void 0!==u?u:null,secondary:null!==(l=null===(d=b[1])||void 0===d?void 0:d.uuid)&&void 0!==l?l:null},3:{primary:null!==(f=null===(p=g[2])||void 0===p?void 0:p.uuid)&&void 0!==f?f:null,secondary:null!==(h=null===(y=b[2])||void 0===y?void 0:y.uuid)&&void 0!==h?h:null}});case 8:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"_onSetChange",value:(t=y(c().mark((function e(t){var n,r,a,i,o,u,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.sets,r=t.active,game.settings.get("enhancedcombathud-dnd5e","switchEquip")){e.next=4;break}return e.abrupt("return");case 4:return a=[],i=n[r],o=Object.values(i).filter((function(e){return e})),u=Object.values(n).filter((function(e){return e!==i})),s=u.flatMap((function(e){return Object.values(e)})).filter((function(e){return e})),o.forEach((function(e){var t;null!==(t=e.system)&&void 0!==t&&t.equipped||a.push({_id:e.id,"system.equipped":!0})})),s.forEach((function(e){var t;null!==(t=e.system)&&void 0!==t&&t.equipped&&a.push({_id:e.id,"system.equipped":!1})})),e.next=13,this.actor.updateEmbeddedDocuments("Item",a);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}]),i}(t.WeaponSets);e.definePortraitPanel(s),e.defineDrawerPanel(h),e.defineMainPanels([g,b,w,k,t.PREFAB.PassTurnPanel]),e.defineMovementHud(N),e.defineWeaponSets(T),e.defineSupportedActorTypes(["character","npc"])}function D(e,t){return E.apply(this,arguments)}function E(){return(E=y(c().mark((function e(t,r){var i,o,u,s,l,d,f,p,m,h,y,v,g,b,w,k,x,O,A,N,T,D,E,j,S,P;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(h=[],y=[],v="","skill"!=r){e.next=8;break}u=CONFIG.DND5E.skills[t].label,s=game.i18n.localize("enhancedcombathud-dnd5e.skills.".concat(t,".tooltip")),e.next=45;break;case 8:if("save"!=r){e.next=13;break}u=CONFIG.DND5E.abilities[t].label,s=game.i18n.localize("enhancedcombathud-dnd5e.abilities.".concat(t,".tooltip")),e.next=45;break;case 13:if(t&&t.system){e.next=15;break}return e.abrupt("return");case 15:u=t.name,s=t.system.description.value,l=t.type,f=(null===(g=t.labels)||void 0===g?void 0:g.target)||"-",p=(null===(b=t.labels)||void 0===b?void 0:b.range)||"-",y=[],m=null===(w=t.labels)||void 0===w||null===(w=w.damageTypes)||void 0===w?void 0:w.split(", "),h=m&&m.length?m:[],v="",e.t0=l,e.next="weapon"===e.t0?27:"spell"===e.t0?31:"consumable"===e.t0?39:"feat"===e.t0?42:45;break;case 27:for(d=CONFIG.DND5E.weaponTypes[t.system.weaponType],y.push(CONFIG.DND5E.itemActionTypes[t.system.actionType]),k=0,x=Object.entries(t.system.properties);k<x.length;k++)O=a(x[k],2),A=O[0],N=O[1],(T=N&&CONFIG.DND5E.weaponProperties[A]?CONFIG.DND5E.weaponProperties[A]:void 0)&&y.push(T);return e.abrupt("break",45);case 31:d="".concat(t.labels.level," ").concat(t.labels.school),y.push(CONFIG.DND5E.spellSchools[t.system.school]),y.push(t.labels.duration),y.push(t.labels.save),D=n(t.labels.components.all);try{for(D.s();!(E=D.n()).done;)j=E.value,y.push(j.abbr)}catch(e){D.e(e)}finally{D.f()}return t.labels.materials&&(v=t.labels.materials),e.abrupt("break",45);case 39:return d=CONFIG.DND5E.consumableTypes[t.system.consumableType],y.push(CONFIG.DND5E.itemActionTypes[t.system.actionType]),e.abrupt("break",45);case 42:return d=t.system.requirements,y.push(CONFIG.DND5E.itemActionTypes[t.system.actionType]),e.abrupt("break",45);case 45:if(!s){e.next=49;break}return e.next=48,TextEditor.enrichHTML(s);case 48:s=e.sent;case 49:return S=[],(f||p)&&(S=[{label:"enhancedcombathud-dnd5e.tooltip.target.name",value:f},{label:"enhancedcombathud-dnd5e.tooltip.range.name",value:p}]),P=[],null!==(i=h)&&void 0!==i&&i.length&&h.forEach((function(e){return P.push({label:e,primary:!0})})),null!==(o=y)&&void 0!==o&&o.length&&y.forEach((function(e){return P.push({label:e,secondary:!0})})),e.abrupt("return",{title:u,description:s,subtitle:d,details:S,properties:P,footerText:v});case 55:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function j(e){return 0==e?'<i style="margin-right: 1ch; pointer-events: none" class="far fa-circle"> </i>':1==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-check"> </i>':2==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-check-double"> </i>':.5==e?'<i style="margin-right: 1ch; pointer-events: none" class="fas fa-adjust"> </i>':'<i style="margin-right: 1ch; pointer-events: none" class="far fa-circle"> </i>'}}))}))})();
//# sourceMappingURL=index.js.map